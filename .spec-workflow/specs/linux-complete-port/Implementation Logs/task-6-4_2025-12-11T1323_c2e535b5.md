# Implementation Log: Task 6.4

**Summary:** Implemented yamy-ctl command-line tool for controlling running YAMY instance. Created IPC control server using Unix domain sockets at /tmp/yamy-engine.sock. Tool supports reload, stop, start, and status commands with --config, --socket, --timeout, and --help options. Integrated control server into main_qt.cpp with proper command handling callback.

**Timestamp:** 2025-12-11T13:23:55.053Z
**Log ID:** c2e535b5-ecdc-4f3e-9c2e-f81b9ac21554

---

## Statistics

- **Lines Added:** +950
- **Lines Removed:** -3
- **Files Changed:** 10
- **Net Change:** 947

## Files Modified
- src/core/ipc_messages.h
- src/app/main_qt.cpp
- CMakeLists.txt
- src/core/platform/ipc_channel_interface.h
- src/core/engine/engine.h
- src/ui/qt/dialog_condition_generator_qt.cpp
- src/ui/qt/dialog_investigate_qt.h

## Files Created
- src/app/yamy_ctl.cpp
- src/platform/linux/ipc_control_server.h
- src/platform/linux/ipc_control_server.cpp

---

## Artifacts

### Functions

#### printUsage
- **Purpose:** Print help text for yamy-ctl commands and options
- **Location:** src/app/yamy_ctl.cpp:52
- **Signature:** (const char* progName) -> void
- **Exported:** No

#### connectToEngine
- **Purpose:** Connect to YAMY engine via Unix domain socket
- **Location:** src/app/yamy_ctl.cpp:84
- **Signature:** (const char* socketPath) -> int
- **Exported:** No

#### sendMessage
- **Purpose:** Send IPC message to engine with type and optional data
- **Location:** src/app/yamy_ctl.cpp:105
- **Signature:** (int sock, MessageType type, const std::string& data) -> bool
- **Exported:** No

#### receiveResponse
- **Purpose:** Receive response from engine with timeout
- **Location:** src/app/yamy_ctl.cpp:129
- **Signature:** (int sock, int timeoutMs, MessageType& type, std::string& data) -> bool
- **Exported:** No

#### cmdReload
- **Purpose:** Execute reload command to reload/switch configuration
- **Location:** src/app/yamy_ctl.cpp:174
- **Signature:** (int sock, int timeoutMs, const std::string& configName) -> int
- **Exported:** No

#### cmdStop
- **Purpose:** Execute stop command to stop the engine
- **Location:** src/app/yamy_ctl.cpp:201
- **Signature:** (int sock, int timeoutMs) -> int
- **Exported:** No

#### cmdStart
- **Purpose:** Execute start command to start the engine
- **Location:** src/app/yamy_ctl.cpp:223
- **Signature:** (int sock, int timeoutMs) -> int
- **Exported:** No

#### cmdStatus
- **Purpose:** Execute status command to get engine status
- **Location:** src/app/yamy_ctl.cpp:245
- **Signature:** (int sock, int timeoutMs) -> int
- **Exported:** No

### Classes

#### IPCControlServer
- **Purpose:** Unix domain socket server for handling yamy-ctl commands in the engine
- **Location:** src/platform/linux/ipc_control_server.h
- **Methods:** setCommandCallback, start, stop, isRunning, socketPath, serverLoop, handleClient
- **Exported:** Yes

### Integrations

#### Integration
- **Description:** yamy-ctl connects to engine via Unix domain socket at /tmp/yamy-engine.sock
- **Frontend Component:** yamy-ctl (CLI)
- **Backend Endpoint:** IPCControlServer
- **Data Flow:** yamy-ctl connects -> sends MessageHeader + data -> server receives -> executes callback -> sends response -> yamy-ctl prints result

